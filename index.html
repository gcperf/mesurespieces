<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>GC Epox-Design – Calcul surface thermolaquage</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    :root {
      --bg: #050510;
      --bg-soft: #10111b;
      --bg-card: #151624;
      --border: #272842;
      --accent: #ff4b8a;
      --accent-soft: rgba(255,75,138,0.1);
      --accent-2: #05f2db;
      --text: #f7f7ff;
      --muted: #9b9dc0;
      --danger: #ff7575;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      padding: 18px;
      background: radial-gradient(circle at top left,#1b1b3a 0,#050510 48%,#020208 100%);
      color: var(--text);
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    .shell {
      max-width: 1100px;
      margin: 0 auto;
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .header {
      display: flex;
      gap: 16px;
      align-items: center;
      padding: 14px 16px;
      border-radius: 18px;
      background: linear-gradient(135deg, rgba(5,242,219,0.14), rgba(255,75,138,0.08));
      border: 1px solid rgba(255,255,255,0.08);
      box-shadow: 0 18px 40px rgba(0,0,0,0.65);
      backdrop-filter: blur(20px);
    }

    .logo-wrap {
      width: 70px;
      height: 70px;
      flex-shrink: 0;
      border-radius: 20px;
      border: 1px solid rgba(255,255,255,0.14);
      background: radial-gradient(circle at 20% 0, #ffffff22 0, #10111b 40%, #050510 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }

    .logo-wrap img {
      max-width: 100%;
      max-height: 100%;
      object-fit: contain;
    }

    .brand-main { flex: 1; }

    .brand-title {
      font-size: 1.5rem;
      font-weight: 700;
      letter-spacing: 0.03em;
      display: flex;
      align-items: baseline;
      gap: 6px;
    }

    .brand-title .highlight { color: var(--accent-2); }

    .brand-sub {
      font-size: 0.9rem;
      color: var(--muted);
      margin-top: 4px;
    }

    .brand-tags {
      margin-top: 6px;
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
    }

    .tag {
      font-size: 0.75rem;
      padding: 3px 9px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,0.14);
      background: rgba(1,2,20,0.8);
      color: var(--muted);
    }

    .header-right {
      text-align: right;
      font-size: 0.8rem;
      color: var(--muted);
    }

    .header-right strong { color: var(--accent-2); }

    .card {
      background: radial-gradient(circle at top left,#252747 0,#151624 40%,#090914 100%);
      border-radius: 16px;
      padding: 14px 14px 12px;
      border: 1px solid var(--border);
      box-shadow: 0 14px 32px rgba(0,0,0,0.6);
    }

    .card-soft {
      background: rgba(10,11,25,0.92);
      border-radius: 14px;
      padding: 10px 12px;
      border: 1px solid rgba(68,72,125,0.9);
    }

    .section-title {
      font-size: 0.98rem;
      font-weight: 600;
      margin-bottom: 6px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .section-title::before {
      content: "";
      display: inline-block;
      width: 6px;
      height: 18px;
      border-radius: 999px;
      background: linear-gradient(180deg,var(--accent-2),var(--accent));
    }

    label {
      font-size: 0.84rem;
      display: block;
      margin-bottom: 3px;
    }

    input, select {
      width: 100%;
      padding: 7px 9px;
      border-radius: 10px;
      border: 1px solid #32345b;
      background: rgba(4,5,20,0.95);
      color: var(--text);
      font-size: 0.88rem;
      margin-bottom: 8px;
      outline: none;
      transition: border-color 0.15s ease, box-shadow 0.15s ease, background 0.15s ease;
    }

    input:focus, select:focus {
      border-color: var(--accent-2);
      box-shadow: 0 0 0 1px rgba(5,242,219,0.35);
      background: #050617;
    }

    .row {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    .row > div {
      flex: 1;
      min-width: 145px;
    }

    .tabs {
      display: flex;
      gap: 8px;
      margin-bottom: 8px;
      padding: 3px;
      border-radius: 999px;
      background: rgba(9,10,30,0.9);
      border: 1px solid rgba(72,75,129,0.9);
    }

    .tab-btn {
      flex: 1;
      padding: 7px 4px;
      border-radius: 999px;
      border: none;
      font-size: 0.86rem;
      cursor: pointer;
      background: transparent;
      color: var(--muted);
      font-weight: 500;
    }

    .tab-btn.active {
      background: linear-gradient(135deg,var(--accent-2),var(--accent));
      color: #050510;
      box-shadow: 0 0 0 1px rgba(0,0,0,0.4);
    }

    .small {
      font-size: 0.76rem;
      color: var(--muted);
    }

    .badge {
      display: inline-block;
      padding: 2px 6px;
      border-radius: 999px;
      font-size: 0.7rem;
      background: rgba(12,13,28,0.92);
      border: 1px solid rgba(94,98,160,0.9);
      margin-left: 4px;
      color: var(--muted);
    }

    button {
      border-radius: 999px;
      border: none;
      cursor: pointer;
      font-size: 0.87rem;
      font-weight: 600;
      padding: 8px 12px;
      transition: transform 0.12s ease, box-shadow 0.12s ease, background 0.12s ease;
    }

    button:active { transform: scale(0.97); }

    .btn-main {
      background: radial-gradient(circle at top left,var(--accent-2),var(--accent));
      color: #050510;
      width: 100%;
      margin-top: 4px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.65);
    }

    .btn-secondary {
      background: rgba(16,18,40,0.94);
      color: var(--muted);
      border: 1px solid rgba(84,88,145,0.9);
    }

    .btn-danger {
      background: rgba(90,20,35,0.9);
      color: #ffd5d5;
      border: 1px solid rgba(255,117,117,0.9);
    }

    .btn-main:hover { box-shadow: 0 10px 24px rgba(0,0,0,0.75); }
    .btn-secondary:hover { background: rgba(25,27,60,0.96); }

    .result {
      margin-top: 8px;
      padding: 8px;
      border-radius: 11px;
      border: 1px solid rgba(58,60,102,0.95);
      background: radial-gradient(circle at top,#22243f 0,#0a0b17 55%,#060712 100%);
      font-size: 0.9rem;
    }

    .result strong { color: var(--accent-2); }
    .result em { color: var(--muted); }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.83rem;
    }

    th, td {
      border-bottom: 1px solid rgba(46,48,85,0.9);
      padding: 4px 6px;
      text-align: left;
      white-space: nowrap;
    }

    th {
      background: radial-gradient(circle at top,#2a2d52 0,#16172a 55%);
      position: sticky;
      top: 0;
      z-index: 1;
    }

    .text-right { text-align: right; }

    .totaux {
      margin-top: 6px;
      font-size: 0.9rem;
      color: var(--text);
    }

    .totaux strong { color: var(--accent-2); }

    .footer {
      margin-top: 6px;
      padding: 10px 12px;
      border-radius: 14px;
      background: rgba(4,5,18,0.96);
      border: 1px solid rgba(58,60,102,0.85);
      font-size: 0.78rem;
      color: var(--muted);
      display: flex;
      flex-wrap: wrap;
      gap: 4px 16px;
      justify-content: space-between;
    }

    @media (max-width: 700px) {
      body { padding: 12px; }
      .header { flex-direction: row; align-items: flex-start; }
      .header-right { text-align: left; }
    }
  </style>
</head>
<body>
  <div class="shell">

    <!-- HEADER -->
    <header class="header">
      <div class="logo-wrap">
        <img src="logo-gc-epox-design.png" alt="Logo GC Epox-Design" />
      </div>

      <div class="brand-main">
        <div class="brand-title">
          <span>GC</span><span class="highlight">Epox-Design</span>
        </div>
        <div class="brand-sub">
          Calculateur surface & devis thermolaquage – tubes, limons, garde-corps, pièces soudées.
        </div>
        <div class="brand-tags">
          <span class="tag">Sablage</span>
          <span class="tag">Thermolaquage</span>
          <span class="tag">Acier · Inox · Alu</span>
          <span class="tag">Tarifs 2025</span>
        </div>
      </div>

      <div class="header-right">
        <div><strong>GC Epox-Design</strong></div>
        <div>38 route de la Pépinière<br/>67160 Wissembourg</div>
        <div>Tél. : 07.83.99.27.94</div>
      </div>
    </header>

    <!-- PARAMETRES / TARIFS -->
    <section class="card">
      <div class="section-title">Paramètres devis & tarifs 2025</div>

      <div class="row">
        <div>
          <label>Tarif peinture libre (€/m²)</label>
          <input type="number" id="prixM2" placeholder="ex : 35" />
        </div>
        <div>
          <label>Conso poudre (kg/m²)</label>
          <input type="number" id="poudreM2" placeholder="ex : 0.12" />
        </div>
      </div>

      <div class="row">
        <div class="card-soft">
          <div class="section-title">Tôlerie – prix HT au m²</div>
          <div class="small">Modifiable, d’après ta grille.</div>

          <label>Tôle noire – laq 2 f</label>
          <input type="number" id="tarif_tole_noire_laq2" value="50" />

          <label>Tôle EZ / acier non calaminé – laq 1 f</label>
          <input type="number" id="tarif_tole_ez_laq1" value="25" />

          <label>Tôle EZ / acier non calaminé – laq 2 f</label>
          <input type="number" id="tarif_tole_ez_laq2" value="33" />

          <label>Limon avec plis – laq 2 f avec plis</label>
          <input type="number" id="tarif_limon_plis" value="38" />

          <label>Tôle alu + galva pleine ou perforée – laq 1 f</label>
          <input type="number" id="tarif_tole_alu_galva_laq1" value="25" />

          <label>Tôle alu + galva pleine ou perforée – laq 2 f</label>
          <input type="number" id="tarif_tole_alu_galva_laq2" value="32" />

          <label>Tôle alu + galva pleine ou perforée – laq 2 f avec plis</label>
          <input type="number" id="tarif_tole_alu_galva_plis" value="42" />

          <label>Tôle alu petit format (&lt; 1 m²) – laq 2 f</label>
          <input type="number" id="tarif_tole_alu_petit" value="40" />

          <label>Inox / Fonte – laq 1 f</label>
          <input type="number" id="tarif_inox_laq1" value="35" />

          <label>Inox / Fonte – laq 2 f</label>
          <input type="number" id="tarif_inox_laq2" value="47" />

          <label>Tôle perforée acier – laq 2 f</label>
          <input type="number" id="tarif_tole_perforee" value="50" />
        </div>

        <div class="card-soft">
          <div class="section-title">Gardes-corps – HT au m² (maxi 6 m)</div>
          <div class="small">Neuf / rénovation.</div>

          <label>GC barreautés – neuf</label>
          <input type="number" id="tarif_gc_barreautes_neuf" value="39" />

          <label>GC barreautés – rénovation</label>
          <input type="number" id="tarif_gc_barreautes_reno" value="48.5" />

          <label>GC tôles – neuf</label>
          <input type="number" id="tarif_gc_toles_neuf" value="47" />

          <label>GC tôles – rénovation</label>
          <input type="number" id="tarif_gc_toles_reno" value="51.5" />

          <label>GC alu galva</label>
          <input type="number" id="tarif_gc_alu_galva" value="34" />

          <label>GC galva / alu forgé</label>
          <input type="number" id="tarif_gc_galva_forge" value="37" />

          <label>GC forgé – neuf</label>
          <input type="number" id="tarif_gc_forge_neuf" value="79" />

          <label>GC forgé – rénovation</label>
          <input type="number" id="tarif_gc_forge_reno" value="95" />

          <label>GC mikado</label>
          <input type="number" id="tarif_gc_mikado" value="60" />

          <label>GC barreautage chargé – neuf</label>
          <input type="number" id="tarif_gc_barreautage_neuf" value="47" />

          <label>GC barreautage chargé – rénovation</label>
          <input type="number" id="tarif_gc_barreautage_reno" value="55" />
        </div>
      </div>

      <p class="small" style="margin-top:6px;">
        Tu choisis ces types de tarif plus bas dans chaque pièce, comme sur ta grille papier.
      </p>
    </section>

    <!-- CALCULATEUR -->
    <section class="card">
      <div class="tabs">
        <button class="tab-btn active" data-tab="simple">Forme simple</button>
        <button class="tab-btn" data-tab="limon">Limon / pièce soudée</button>
      </div>

      <!-- FORMES SIMPLES -->
      <div class="tab-content" id="tab-simple">
        <div class="section-title">Forme simple</div>

        <div class="row">
          <div>
            <label>Type de pièce (géométrie)</label>
            <select id="simpleType">
              <option value="plaque">Plaque / tôle</option>
              <option value="tubeRect">Tube carré / rectangulaire</option>
              <option value="tubeRond">Tube rond</option>
              <option value="corniereL">Cornière L</option>
              <option value="profilU">Profil U</option>
              <option value="plat">Plat (fer plat)</option>
              <option value="perimetreLibre">Profil spécial (périmètre connu)</option>
            </select>
          </div>
          <div>
            <label>Nom / référence pièce</label>
            <input type="text" id="simpleRef" placeholder="ex : GC barreautés palier" />
          </div>
        </div>

        <label>Type de tarif (comme la photo)</label>
        <select id="simpleTarifType">
          <option value="">Tarif libre (champ en haut)</option>
          <optgroup label="Tôlerie">
            <option value="tole_noire_laq2">Tôle noire – laq 2 f</option>
            <option value="tole_ez_laq1">Tôle EZ / acier non calaminé – laq 1 f</option>
            <option value="tole_ez_laq2">Tôle EZ / acier non calaminé – laq 2 f</option>
            <option value="limon_plis">Limon avec plis – laq 2 f avec plis</option>
            <option value="tole_alu_galva_laq1">Tôle alu + galva – laq 1 f</option>
            <option value="tole_alu_galva_laq2">Tôle alu + galva – laq 2 f</option>
            <option value="tole_alu_galva_plis">Tôle alu + galva – laq 2 f avec plis</option>
            <option value="tole_alu_petit">Tôle alu petit format</option>
            <option value="inox_laq1">Inox / fonte – laq 1 f</option>
            <option value="inox_laq2">Inox / fonte – laq 2 f</option>
            <option value="tole_perforee">Tôle perforée acier</option>
          </optgroup>
          <optgroup label="Gardes-corps">
            <option value="gc_barreautes_neuf">GC barreautés – neuf</option>
            <option value="gc_barreautes_reno">GC barreautés – rénovation</option>
            <option value="gc_toles_neuf">GC tôles – neuf</option>
            <option value="gc_toles_reno">GC tôles – rénovation</option>
            <option value="gc_alu_galva">GC alu galva</option>
            <option value="gc_galva_forge">GC galva / alu forgé</option>
            <option value="gc_forge_neuf">GC forgé – neuf</option>
            <option value="gc_forge_reno">GC forgé – rénovation</option>
            <option value="gc_mikado">GC mikado</option>
            <option value="gc_barreautage_neuf">GC barreautage chargé – neuf</option>
            <option value="gc_barreautage_reno">GC barreautage chargé – rénovation</option>
          </optgroup>
        </select>

        <!-- Plaque -->
        <div id="blocSimple-plaque" class="blocSimple">
          <div class="row">
            <div>
              <label>Longueur (mm)</label>
              <input type="number" id="plaqueLongueur" placeholder="ex : 1200" />
            </div>
            <div>
              <label>Largeur (mm)</label>
              <input type="number" id="plaqueLargeur" placeholder="ex : 400" />
            </div>
          </div>
          <label>Faces à peindre</label>
          <select id="plaqueFaces">
            <option value="1">1 face</option>
            <option value="2">2 faces</option>
          </select>
        </div>

        <!-- Tube rect -->
        <div id="blocSimple-tubeRect" class="blocSimple" style="display:none;">
          <div class="row">
            <div>
              <label>Largeur (mm)</label>
              <input type="number" id="tubeRectLargeur" placeholder="ex : 40" />
            </div>
            <div>
              <label>Hauteur (mm)</label>
              <input type="number" id="tubeRectHauteur" placeholder="ex : 40" />
            </div>
          </div>
          <label>Longueur du tube (mm)</label>
          <input type="number" id="tubeRectLongueur" placeholder="ex : 2000" />
          <p class="small">Surface extérieure : 2 × (L + H) × longueur.</p>
        </div>

        <!-- Tube rond -->
        <div id="blocSimple-tubeRond" class="blocSimple" style="display:none;">
          <label>Diamètre extérieur (mm)</label>
          <input type="number" id="tubeRondDiametre" placeholder="ex : 60" />
          <label>Longueur du tube (mm)</label>
          <input type="number" id="tubeRondLongueur" placeholder="ex : 2000" />
          <p class="small">Surface extérieure : π × D × longueur.</p>
        </div>

        <!-- Cornière L -->
        <div id="blocSimple-corniereL" class="blocSimple" style="display:none;">
          <div class="row">
            <div>
              <label>Aile 1 (mm)</label>
              <input type="number" id="corniereAile1" placeholder="ex : 40" />
            </div>
            <div>
              <label>Aile 2 (mm)</label>
              <input type="number" id="corniereAile2" placeholder="ex : 40" />
            </div>
          </div>
          <label>Épaisseur (mm)</label>
          <input type="number" id="corniereEpaisseur" placeholder="ex : 4" />
          <label>Longueur (mm)</label>
          <input type="number" id="corniereLongueur" placeholder="ex : 2000" />
          <p class="small">
            Approximatif : développé ≈ (aile1 + aile2 − épaisseur) × 2 (faces) × longueur.
          </p>
        </div>

        <!-- Profil U -->
        <div id="blocSimple-profilU" class="blocSimple" style="display:none;">
          <div class="row">
            <div>
              <label>Largeur semelle (mm)</label>
              <input type="number" id="uSemelle" placeholder="ex : 80" />
            </div>
            <div>
              <label>Hauteur (mm)</label>
              <input type="number" id="uHauteur" placeholder="ex : 40" />
            </div>
          </div>
          <label>Épaisseur (mm)</label>
          <input type="number" id="uEpaisseur" placeholder="ex : 4" />
          <label>Longueur (mm)</label>
          <input type="number" id="uLongueur" placeholder="ex : 3000" />
          <p class="small">
            Approximatif : développé ≈ (semelle + 2 × hauteur) × 2 (faces) × longueur.
          </p>
        </div>

        <!-- Plat -->
        <div id="blocSimple-plat" class="blocSimple" style="display:none;">
          <div class="row">
            <div>
              <label>Largeur du plat (mm)</label>
              <input type="number" id="platLargeur" placeholder="ex : 80" />
            </div>
            <div>
              <label>Épaisseur (mm)</label>
              <input type="number" id="platEpaisseur" placeholder="ex : 8" />
            </div>
          </div>
          <label>Longueur (mm)</label>
          <input type="number" id="platLongueur" placeholder="ex : 3000" />
          <p class="small">
            Surface ≈ 2 faces larges + 2 chants : 2×(largeur×longueur) + 2×(épaisseur×longueur).
          </p>
        </div>

        <!-- Périmètre libre -->
        <div id="blocSimple-perimetreLibre" class="blocSimple" style="display:none;">
          <label>Périmètre développé extérieur (mm)</label>
          <input type="number" id="perimLibre" placeholder="ex : 300" />
          <label>Longueur du profil (mm)</label>
          <input type="number" id="perimLibreLongueur" placeholder="ex : 2000" />
          <p class="small">Pour profil spécial : développé × longueur.</p>
        </div>

        <div class="row">
          <div>
            <label>Quantité de pièces</label>
            <input type="number" id="simpleQuantite" value="1" min="1" />
          </div>
        </div>

        <button class="btn-main" id="btnCalcSimple">Calculer surface (forme simple)</button>
        <button class="btn-main" id="btnAddSimple" style="margin-top:6px;">Ajouter au devis</button>

        <div class="result" id="resultSimple">
          Renseigne les dimensions puis clique sur <strong>Calculer</strong>.
        </div>
      </div>

      <!-- LIMON -->
      <div class="tab-content" id="tab-limon" style="display:none;">
        <div class="section-title">Limon / pièce soudée avec supports</div>

        <div class="row">
          <div>
            <label>Nom / référence limon</label>
            <input type="text" id="limonRef" placeholder="ex : Limon avec plis" />
          </div>
          <div>
            <label>Type de limon (profil principal)</label>
            <select id="limonType">
              <option value="tubeRect">Tube carré / rectangulaire</option>
              <option value="tubeRond">Tube rond</option>
              <option value="plat">Plat</option>
              <option value="profilU">Profil U</option>
              <option value="perimetreLibre">Profil spécial (périmètre connu)</option>
            </select>
          </div>
        </div>

        <label>Type de tarif (comme la photo)</label>
        <select id="limonTarifType">
          <option value="">Tarif libre (champ en haut)</option>
          <option value="limon_plis" selected>Limon avec plis – laq 2 f avec plis</option>
          <optgroup label="Gardes-corps">
            <option value="gc_barreautes_neuf">GC barreautés – neuf</option>
            <option value="gc_barreautes_reno">GC barreautés – rénovation</option>
            <option value="gc_toles_neuf">GC tôles – neuf</option>
            <option value="gc_toles_reno">GC tôles – rénovation</option>
            <option value="gc_alu_galva">GC alu galva</option>
            <option value="gc_galva_forge">GC galva / alu forgé</option>
            <option value="gc_forge_neuf">GC forgé – neuf</option>
            <option value="gc_forge_reno">GC forgé – rénovation</option>
            <option value="gc_mikado">GC mikado</option>
            <option value="gc_barreautage_neuf">GC barreautage chargé – neuf</option>
            <option value="gc_barreautage_reno">GC barreautage chargé – rénovation</option>
          </optgroup>
        </select>

        <!-- Profils limon -->
        <div id="blocLimon-tubeRect" class="blocLimon">
          <div class="row">
            <div>
              <label>Largeur tube (mm)</label>
              <input type="number" id="limonTubeRectLargeur" placeholder="ex : 120" />
            </div>
            <div>
              <label>Hauteur tube (mm)</label>
              <input type="number" id="limonTubeRectHauteur" placeholder="ex : 60" />
            </div>
          </div>
        </div>

        <div id="blocLimon-tubeRond" class="blocLimon" style="display:none;">
          <label>Diamètre tube (mm)</label>
          <input type="number" id="limonTubeRondDiametre" placeholder="ex : 80" />
        </div>

        <div id="blocLimon-plat" class="blocLimon" style="display:none;">
          <div class="row">
            <div>
              <label>Largeur plat (mm)</label>
              <input type="number" id="limonPlatLargeur" placeholder="ex : 200" />
            </div>
            <div>
              <label>Épaisseur (mm)</label>
              <input type="number" id="limonPlatEpaisseur" placeholder="ex : 10" />
            </div>
          </div>
        </div>

        <div id="blocLimon-profilU" class="blocLimon" style="display:none;">
          <div class="row">
            <div>
              <label>Largeur semelle U (mm)</label>
              <input type="number" id="limonUSemelle" placeholder="ex : 200" />
            </div>
            <div>
              <label>Hauteur U (mm)</label>
              <input type="number" id="limonUHauteur" placeholder="ex : 80" />
            </div>
          </div>
          <label>Épaisseur (mm)</label>
          <input type="number" id="limonUEpaisseur" placeholder="ex : 8" />
        </div>

        <div id="blocLimon-perimetreLibre" class="blocLimon" style="display:none;">
          <label>Périmètre développé du profil (mm)</label>
          <input type="number" id="limonPerimLibre" placeholder="ex : 450" />
        </div>

        <label>Longueur du limon / pièce (mm)</label>
        <input type="number" id="limonLongueur" placeholder="ex : 4000" />

        <!-- Supports -->
        <div style="margin-top:8px;">
          <div class="section-title">
            Supports de marche
            <span class="badge">Optionnel</span>
          </div>

          <p class="small">
            Approximatif : support en “L” (vertical + horizontal) en plat.
          </p>

          <div class="row">
            <div>
              <label>Largeur support (mm)</label>
              <input type="number" id="supportLargeur" placeholder="ex : 200" />
            </div>
            <div>
              <label>Hauteur verticale (mm)</label>
              <input type="number" id="supportHauteur" placeholder="ex : 150" />
            </div>
          </div>

          <div class="row">
            <div>
              <label>Longueur horizontale (mm)</label>
              <input type="number" id="supportLongueur" placeholder="ex : 250" />
            </div>
            <div>
              <label>Épaisseur plat (mm)</label>
              <input type="number" id="supportEpaisseur" placeholder="ex : 8" />
            </div>
          </div>

          <div class="row">
            <div>
              <label>Nombre de marches / supports</label>
              <input type="number" id="supportNb" value="0" />
            </div>
            <div>
              <label>Quantité de limons identiques</label>
              <input type="number" id="limonQuantite" value="1" min="1" />
            </div>
          </div>
        </div>

        <button class="btn-main" id="btnCalcLimon">Calculer surface (limon + supports)</button>
        <button class="btn-main" id="btnAddLimon" style="margin-top:6px;">Ajouter au devis</button>

        <div class="result" id="resultLimon">
          Renseigne les cotes du limon (et des supports si besoin), puis clique sur <strong>Calculer</strong>.
        </div>
      </div>
    </section>

    <!-- RECAP -->
    <section class="card">
      <div class="section-title">Récap devis – GC Epox-Design</div>
      <p class="small">
        Chaque clic sur <strong>“Ajouter au devis”</strong> ajoute une ligne ci-dessous.
      </p>

      <div class="card-soft" style="max-height: 260px; overflow:auto; margin-bottom:6px;">
        <table id="tableDevis">
          <thead>
          <tr>
            <th>#</th>
            <th>Référence</th>
            <th>Type</th>
            <th class="text-right">Qté</th>
            <th class="text-right">Surf/pièce (m²)</th>
            <th class="text-right">Surf totale (m²)</th>
            <th class="text-right">Prix (€)</th>
            <th class="text-right">Poudre (kg)</th>
          </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>

      <div class="totaux" id="totauxDevis">
        Aucun élément pour l’instant.
      </div>

      <div style="margin-top:8px; display:flex; gap:8px; flex-wrap:wrap;">
        <button class="btn-secondary btn-danger" id="btnResetDevis">Vider le devis</button>
      </div>
    </section>

    <footer class="footer">
      <div>© GC Epox-Design – Outil interne de calcul de surfaces pour sablage & thermolaquage.</div>
      <div>Atelier : 38 route de la Pépinière, 67160 Wissembourg – Tél. 07.83.99.27.94</div>
    </footer>
  </div>

  <script>
    function parseNumber(value) {
      if (!value && value !== 0) return 0;
      return parseFloat(String(value).replace(",", ".")) || 0;
    }
    function mmToM(mm) { return mm / 1000; }

    // mapping tarif -> id input
    const TARIF_INPUT_IDS = {
      tole_noire_laq2: "tarif_tole_noire_laq2",
      tole_ez_laq1: "tarif_tole_ez_laq1",
      tole_ez_laq2: "tarif_tole_ez_laq2",
      limon_plis: "tarif_limon_plis",
      tole_alu_galva_laq1: "tarif_tole_alu_galva_laq1",
      tole_alu_galva_laq2: "tarif_tole_alu_galva_laq2",
      tole_alu_galva_plis: "tarif_tole_alu_galva_plis",
      tole_alu_petit: "tarif_tole_alu_petit",
      inox_laq1: "tarif_inox_laq1",
      inox_laq2: "tarif_inox_laq2",
      tole_perforee: "tarif_tole_perforee",
      gc_barreautes_neuf: "tarif_gc_barreautes_neuf",
      gc_barreautes_reno: "tarif_gc_barreautes_reno",
      gc_toles_neuf: "tarif_gc_toles_neuf",
      gc_toles_reno: "tarif_gc_toles_reno",
      gc_alu_galva: "tarif_gc_alu_galva",
      gc_galva_forge: "tarif_gc_galva_forge",
      gc_forge_neuf: "tarif_gc_forge_neuf",
      gc_forge_reno: "tarif_gc_forge_reno",
      gc_mikado: "tarif_gc_mikado",
      gc_barreautage_neuf: "tarif_gc_barreautage_neuf",
      gc_barreautage_reno: "tarif_gc_barreautage_reno",
    };

    function getTarifFromKey(key) {
      if (!key) return 0;
      const id = TARIF_INPUT_IDS[key];
      if (!id) return 0;
      const el = document.getElementById(id);
      if (!el) return 0;
      return parseNumber(el.value);
    }

    // Onglets
    const tabButtons = document.querySelectorAll(".tab-btn");
    const tabContents = document.querySelectorAll(".tab-content");
    tabButtons.forEach(btn => {
      btn.addEventListener("click", () => {
        const tab = btn.dataset.tab;
        tabButtons.forEach(b => b.classList.remove("active"));
        btn.classList.add("active");
        tabContents.forEach(c => c.style.display = c.id === "tab-" + tab ? "block" : "none");
      });
    });

    // Formes simples
    const simpleTypeSelect = document.getElementById("simpleType");
    const blocSimpleList = document.querySelectorAll(".blocSimple");
    const resultSimple = document.getElementById("resultSimple");
    function showSimpleBloc() {
      const val = simpleTypeSelect.value;
      blocSimpleList.forEach(b => b.style.display = "none");
      const bloc = document.getElementById("blocSimple-" + val);
      if (bloc) bloc.style.display = "block";
    }
    simpleTypeSelect.addEventListener("change", showSimpleBloc);
    showSimpleBloc();

    function calcSimplePiece() {
      const type = simpleTypeSelect.value;
      const quantite = parseNumber(document.getElementById("simpleQuantite").value) || 1;
      const ref = document.getElementById("simpleRef").value.trim();
      const tarifSelect = document.getElementById("simpleTarifType");
      const tarifKey = tarifSelect.value;
      const tarifLabel = tarifSelect.options[tarifSelect.selectedIndex].text;

      let surfaceParPiece_m2 = 0;
      let details = "";

      if (type === "plaque") {
        const L = mmToM(parseNumber(document.getElementById("plaqueLongueur").value));
        const l = mmToM(parseNumber(document.getElementById("plaqueLargeur").value));
        const faces = parseInt(document.getElementById("plaqueFaces").value, 10) || 1;
        surfaceParPiece_m2 = L * l * faces;
        details = `Plaque ${faces} face(s) – L=${L.toFixed(3)} m, l=${l.toFixed(3)} m.`;
      }
      if (type === "tubeRect") {
        const larg = mmToM(parseNumber(document.getElementById("tubeRectLargeur").value));
        const haut = mmToM(parseNumber(document.getElementById("tubeRectHauteur").value));
        const long = mmToM(parseNumber(document.getElementById("tubeRectLongueur").value));
        const perim = 2 * (larg + haut);
        surfaceParPiece_m2 = perim * long;
        details = `Tube rect : ${larg.toFixed(3)}×${haut.toFixed(3)} m, L=${long.toFixed(3)} m.`;
      }
      if (type === "tubeRond") {
        const d = mmToM(parseNumber(document.getElementById("tubeRondDiametre").value));
        const L = mmToM(parseNumber(document.getElementById("tubeRondLongueur").value));
        surfaceParPiece_m2 = Math.PI * d * L;
        details = `Tube rond D=${d.toFixed(3)} m, L=${L.toFixed(3)} m.`;
      }
      if (type === "corniereL") {
        const a1 = mmToM(parseNumber(document.getElementById("corniereAile1").value));
        const a2 = mmToM(parseNumber(document.getElementById("corniereAile2").value));
        const e = mmToM(parseNumber(document.getElementById("corniereEpaisseur").value));
        const L = mmToM(parseNumber(document.getElementById("corniereLongueur").value));
        const dev_approx = (a1 + a2 - e) * 2;
        surfaceParPiece_m2 = dev_approx * L;
        details = `Cornière L ~ ailes ${a1.toFixed(3)} / ${a2.toFixed(3)} m, ép=${e.toFixed(3)} m, L=${L.toFixed(3)} m.`;
      }
      if (type === "profilU") {
        const sem = mmToM(parseNumber(document.getElementById("uSemelle").value));
        const h = mmToM(parseNumber(document.getElementById("uHauteur").value));
        const e = mmToM(parseNumber(document.getElementById("uEpaisseur").value));
        const L = mmToM(parseNumber(document.getElementById("uLongueur").value));
        const contour = sem + 2 * h;
        const dev_approx = contour * 2;
        surfaceParPiece_m2 = dev_approx * L;
        details = `Profil U ~ semelle=${sem.toFixed(3)} m, h=${h.toFixed(3)} m, L=${L.toFixed(3)} m.`;
      }
      if (type === "plat") {
        const larg = mmToM(parseNumber(document.getElementById("platLargeur").value));
        const e = mmToM(parseNumber(document.getElementById("platEpaisseur").value));
        const L = mmToM(parseNumber(document.getElementById("platLongueur").value));
        const surfFaces = 2 * (larg * L);
        const surfChants = 2 * (e * L);
        surfaceParPiece_m2 = surfFaces + surfChants;
        details = `Plat larg=${larg.toFixed(3)} m, ép=${e.toFixed(3)} m, L=${L.toFixed(3)} m.`;
      }
      if (type === "perimetreLibre") {
        const perim = mmToM(parseNumber(document.getElementById("perimLibre").value));
        const L = mmToM(parseNumber(document.getElementById("perimLibreLongueur").value));
        surfaceParPiece_m2 = perim * L;
        details = `Profil spécial périmètre=${perim.toFixed(3)} m, L=${L.toFixed(3)} m.`;
      }

      if (!surfaceParPiece_m2 || surfaceParPiece_m2 <= 0) {
        resultSimple.innerHTML = "⚠️ Vérifie les dimensions, impossible de calculer la surface.";
        return null;
      }

      const total_m2 = surfaceParPiece_m2 * quantite;
      const refLine = ref ? `Pièce : <strong>${ref}</strong><br>` : "";

      resultSimple.innerHTML = `
        ${refLine}
        ${details}<br>
        Tarif : <em>${tarifKey ? tarifLabel : "tarif libre"}</em><br><br>
        Surface par pièce : <strong>${surfaceParPiece_m2.toFixed(3)} m²</strong><br>
        Quantité : <strong>${quantite}</strong><br>
        Surface totale : <strong>${total_m2.toFixed(3)} m²</strong>
      `;

      return { type, ref, qte: quantite, surfaceParPiece_m2, surfaceTotale_m2: total_m2, tarifKey, tarifLabel };
    }

    document.getElementById("btnCalcSimple").addEventListener("click", calcSimplePiece);

    // Limon
    const limonTypeSelect = document.getElementById("limonType");
    const blocLimonList = document.querySelectorAll(".blocLimon");
    const resultLimon = document.getElementById("resultLimon");
    function showLimonBloc() {
      const val = limonTypeSelect.value;
      blocLimonList.forEach(b => b.style.display = "none");
      const bloc = document.getElementById("blocLimon-" + val);
      if (bloc) bloc.style.display = "block";
    }
    limonTypeSelect.addEventListener("change", showLimonBloc);
    showLimonBloc();

    function calcLimonPiece() {
      const type = limonTypeSelect.value;
      const L_mm = parseNumber(document.getElementById("limonLongueur").value);
      const L_m = mmToM(L_mm);
      const nbLimon = parseNumber(document.getElementById("limonQuantite").value) || 1;
      const ref = document.getElementById("limonRef").value.trim();
      const tarifSelect = document.getElementById("limonTarifType");
      const tarifKey = tarifSelect.value;
      const tarifLabel = tarifSelect.options[tarifSelect.selectedIndex].text;

      if (L_m <= 0) {
        resultLimon.innerHTML = "⚠️ Indique la longueur du limon / profil (mm).";
        return null;
      }

      let surfLimon_m2 = 0;
      let descLimon = "";

      if (type === "tubeRect") {
        const larg = mmToM(parseNumber(document.getElementById("limonTubeRectLargeur").value));
        const haut = mmToM(parseNumber(document.getElementById("limonTubeRectHauteur").value));
        const perim = 2 * (larg + haut);
        surfLimon_m2 = perim * L_m;
        descLimon = `Limon tube rect ~ ${larg.toFixed(3)}×${haut.toFixed(3)} m, L=${L_m.toFixed(3)} m.`;
      }
      if (type === "tubeRond") {
        const d = mmToM(parseNumber(document.getElementById("limonTubeRondDiametre").value));
        surfLimon_m2 = Math.PI * d * L_m;
        descLimon = `Limon tube rond D=${d.toFixed(3)} m, L=${L_m.toFixed(3)} m.`;
      }
      if (type === "plat") {
        const larg = mmToM(parseNumber(document.getElementById("limonPlatLargeur").value));
        const e = mmToM(parseNumber(document.getElementById("limonPlatEpaisseur").value));
        const surfFaces = 2 * (larg * L_m);
        const surfChants = 2 * (e * L_m);
        surfLimon_m2 = surfFaces + surfChants;
        descLimon = `Limon plat larg=${larg.toFixed(3)} m, ép=${e.toFixed(3)} m, L=${L_m.toFixed(3)} m.`;
      }
      if (type === "profilU") {
        const sem = mmToM(parseNumber(document.getElementById("limonUSemelle").value));
        const h = mmToM(parseNumber(document.getElementById("limonUHauteur").value));
        const e = mmToM(parseNumber(document.getElementById("limonUEpaisseur").value));
        const contour = sem + 2 * h;
        const dev_approx = contour * 2;
        surfLimon_m2 = dev_approx * L_m;
        descLimon = `Limon U ~ semelle=${sem.toFixed(3)} m, h=${h.toFixed(3)} m, L=${L_m.toFixed(3)} m.`;
      }
      if (type === "perimetreLibre") {
        const perim = mmToM(parseNumber(document.getElementById("limonPerimLibre").value));
        surfLimon_m2 = perim * L_m;
        descLimon = `Limon profil spécial périmètre=${perim.toFixed(3)} m, L=${L_m.toFixed(3)} m.`;
      }

      if (!surfLimon_m2 || surfLimon_m2 <= 0) {
        resultLimon.innerHTML = "⚠️ Vérifie les dimensions du limon (profil).";
        return null;
      }

      const supportLargeur_m = mmToM(parseNumber(document.getElementById("supportLargeur").value));
      const supportHauteur_m = mmToM(parseNumber(document.getElementById("supportHauteur").value));
      const supportLongueur_m = mmToM(parseNumber(document.getElementById("supportLongueur").value));
      const supportEpaisseur_m = mmToM(parseNumber(document.getElementById("supportEpaisseur").value));
      const supportNb = parseNumber(document.getElementById("supportNb").value) || 0;

      let surfUnSupport_m2 = 0;
      let descSupport = "";

      if (supportNb > 0 && supportLargeur_m > 0 && (supportHauteur_m > 0 || supportLongueur_m > 0)) {
        const surfVertFaces = 2 * (supportLargeur_m * supportHauteur_m);
        const surfHorizFaces = 2 * (supportLargeur_m * supportLongueur_m);
        const surfVertChants = 2 * (supportEpaisseur_m * supportHauteur_m);
        const surfHorizChants = 2 * (supportEpaisseur_m * supportLongueur_m);

        surfUnSupport_m2 = surfVertFaces + surfHorizFaces + surfVertChants + surfHorizChants;
        descSupport = `Support ~ larg=${supportLargeur_m.toFixed(3)} m, h=${supportHauteur_m.toFixed(3)} m, L=${supportLongueur_m.toFixed(3)} m.`;
      }

      const surfSupportsUnLimon_m2 = surfUnSupport_m2 * supportNb;
      const surfTotalUnLimon_m2 = surfLimon_m2 + surfSupportsUnLimon_m2;
      const surfTotalTousLimons_m2 = surfTotalUnLimon_m2 * nbLimon;

      let html = "";
      html += `<strong>Limon (1 pièce) :</strong><br>${descLimon}<br>`;
      html += `Tarif : <em>${tarifKey ? tarifLabel : "tarif libre"}</em><br>`;
      html += `Surface limon seul : <strong>${surfLimon_m2.toFixed(3)} m²</strong><br><br>`;

      if (supportNb > 0 && surfUnSupport_m2 > 0) {
        html += `<strong>Supports de marche :</strong><br>`;
        html += `${descSupport}<br>`;
        html += `Surface 1 support : ~${surfUnSupport_m2.toFixed(3)} m²<br>`;
        html += `Nombre de supports : ${supportNb}<br>`;
        html += `Surface supports / limon : <strong>${surfSupportsUnLimon_m2.toFixed(3)} m²</strong><br><br>`;
      } else {
        html += `<em>Aucun support de marche pris en compte (0 ou dimensions manquantes).</em><br><br>`;
      }

      html += `<strong>Surface totale pour 1 limon :</strong> ${surfTotalUnLimon_m2.toFixed(3)} m²<br>`;
      html += `Quantité de limons identiques : ${nbLimon}<br>`;
      html += `<strong>Surface totale (tous limons) :</strong> ${surfTotalTousLimons_m2.toFixed(3)} m²`;

      resultLimon.innerHTML = html;

      return {
        type: "Limon",
        ref,
        qte: nbLimon,
        surfaceParPiece_m2: surfTotalUnLimon_m2,
        surfaceTotale_m2: surfTotalTousLimons_m2,
        tarifKey,
        tarifLabel
      };
    }

    document.getElementById("btnCalcLimon").addEventListener("click", calcLimonPiece);

    // Recap devis
    const prixM2Input = document.getElementById("prixM2");
    const poudreM2Input = document.getElementById("poudreM2");
    const tableBody = document.querySelector("#tableDevis tbody");
    const totauxDiv = document.getElementById("totauxDevis");
    const btnResetDevis = document.getElementById("btnResetDevis");
    let devisItems = [];

    function ajouterAuDevis(item) {
      if (!item) return;

      let prixM2 = parseNumber(prixM2Input.value);
      const poudreM2 = parseNumber(poudreM2Input.value);

      if (item.tarifKey) {
        const t = getTarifFromKey(item.tarifKey);
        if (t > 0) prixM2 = t;
      }

      const prix = prixM2 > 0 ? item.surfaceTotale_m2 * prixM2 : 0;
      const poudre = poudreM2 > 0 ? item.surfaceTotale_m2 * poudreM2 : 0;

      devisItems.push({
        ref: item.ref && item.ref !== "" ? item.ref : "(sans nom)",
        type: item.type,
        qte: item.qte,
        surfPiece: item.surfaceParPiece_m2,
        surfTotale: item.surfaceTotale_m2,
        prix,
        poudre
      });

      rafraichirTableDevis();
    }

    function rafraichirTableDevis() {
      tableBody.innerHTML = "";
      let totalSurf = 0, totalPrix = 0, totalPoudre = 0;

      devisItems.forEach((it, index) => {
        totalSurf += it.surfTotale;
        totalPrix += it.prix;
        totalPoudre += it.poudre;

        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${index + 1}</td>
          <td>${it.ref}</td>
          <td>${it.type}</td>
          <td class="text-right">${it.qte}</td>
          <td class="text-right">${it.surfPiece.toFixed(3)}</td>
          <td class="text-right">${it.surfTotale.toFixed(3)}</td>
          <td class="text-right">${it.prix > 0 ? it.prix.toFixed(2) : "-"}</td>
          <td class="text-right">${it.poudre > 0 ? it.poudre.toFixed(2) : "-"}</td>
        `;
        tableBody.appendChild(tr);
      });

      if (!devisItems.length) {
        totauxDiv.textContent = "Aucun élément pour l’instant.";
      } else {
        let txt = `Total surface : <strong>${totalSurf.toFixed(3)} m²</strong>`;
        if (totalPrix > 0) txt += ` – Total prix estimatif : <strong>${totalPrix.toFixed(2)} €</strong>`;
        if (totalPoudre > 0) txt += ` – Poudre estimée : <strong>${totalPoudre.toFixed(2)} kg</strong>`;
        totauxDiv.innerHTML = txt;
      }
    }

    btnResetDevis.addEventListener("click", () => {
      devisItems = [];
      rafraichirTableDevis();
    });

    document.getElementById("btnAddSimple").addEventListener("click", () => {
      const item = calcSimplePiece();
      ajouterAuDevis(item);
    });
    document.getElementById("btnAddLimon").addEventListener("click", () => {
      const item = calcLimonPiece();
      ajouterAuDevis(item);
    });
  </script>
</body>
</html>
